# Coupons

A coupon describes a discount that can be applied to [invoices](#invoice-object), [line items](#line-item-object), and [subscriptions](#subscription-object).

## Coupon Object

### Attributes

```shell
<%= json data.coupons.object %>
```

```ruby
#<Invoiced::Coupon:0x3fdbf95e4d08 id=S8L47J> JSON: <%= json data.coupons.object %>
```

```php
Invoiced\Coupon JSON: <%= json data.coupons.object %>
```

```python
<Coupon id=S8L47J at 0x3fdbf95e4d08> JSON: <%= json data.coupons.object %>
```

```java
com.invoiced.entity.Coupon@192cafae JSON: <%= json data.coupons.object %>
```

Parameter | Type | Description
--------- | ---- | -----------
**id** | *string* | The coupon's unique ID
**object** | *string* | Object type, `coupon`
**name** | *string* | Coupon name
**currency** | *string* | [3-letter ISO code](https://en.wikipedia.org/wiki/ISO_4217)
**value** | *number* | Amount
**is_percent** | *boolean* | When true the value is a %
**exclusive** | *boolean* | When true no other coupons can be used simultaneously
**expiration_date** | *timestamp* | Date coupon expires
**max_redemptions** | *integer* | Max number of times coupon can be used
**created_at** | *timestamp* | Timestamp when created
**metadata** | *object* | A hash of key/value pairs that can store additional information about this object.

## Create a coupon

```shell
curl "https://api.invoiced.com/coupons" \
  -u {API_KEY}: \
  -d id="S8L47J" \
  -d name="Non-profit Discount" \
  -d value=20 \
```

```ruby
invoiced.Coupon.create(
  :id => "S8L47J",
  :name => "Non-profit Discount",
  :value => 20
)
```

```php
<?php

$invoiced->Coupon->create([
  'id' => "S8L47J",
  'name' => "Non-profit Discount",
  'value' => 20
]);
```

```python
client.Coupon.create(
  id="S8L47J",
  name="Non-profit Discount",
  value=20
)
```

```java
Coupon coupon = invoiced.newCoupon();
coupon.id = "S8L47J";
coupon.name = "Non-profit Discount";
coupon.value = 20;
coupon.create();
```

> The above command returns JSON structured like this:

```shell
<%= json data.coupons.object %>
```

```ruby
#<Invoiced::Coupon:0x3fdbf95e4d08 id=S8L47J> JSON: <%= json data.coupons.object %>
```

```php
Invoiced\Coupon JSON: <%= json data.coupons.object %>
```

```python
<Coupon id=S8L47J at 0x3fdbf95e4d08> JSON: <%= json data.coupons.object %>
```

```java
com.invoiced.entity.Coupon@cb8fd57 JSON: <%= json data.coupons.object %>
```

Create a new coupon with this endpoint.

### HTTP Request

`POST /coupons`

### Attributes

Parameter | Type | Description
--------- | ---- | -----------
**id** | *integer* | The coupon's unique ID
**name** | *string* | Coupon name
**currency** | *string* | [3-letter ISO code](https://en.wikipedia.org/wiki/ISO_4217)
**value** | *number* | Amount
**is_percent** | *boolean* | When true the value is a %
**exclusive** | *boolean* | When true no other coupons can be used simultaneously
**expiration_date** | *timestamp* | Date coupon expires
**max_redemptions** | *integer* | Max number of times coupon can be used
**metadata** | *object* | A hash of key/value pairs that can store additional information about this object.

## Retrieve a coupon

```shell
curl "https://api.invoiced.com/coupons/:id" \
  -u {API_KEY}:
```

```ruby
coupon = invoiced.Coupon.retrieve("{TXRAT_ID}")
```

```php
<?php

$coupon = $invoiced->Coupon->retrieve("{TXRAT_ID}");
```

```python
coupon = client.Coupon.retrieve("{TXRAT_ID}")
```

```java
Coupon coupon = invoiced.newCoupon().retrieve({TXRAT_ID});

```

> The above command returns JSON structured like this:

```shell
<%= json data.coupons.object %>
```

```ruby
#<Invoiced::Coupon:0x3fdbf95e4d08 id=S8L47J> JSON: <%= json data.coupons.object %>
```

```php
Invoiced\Coupon JSON: <%= json data.coupons.object %>
```

```python
<Coupon id=S8L47J at 0x3fdbf95e4d08> JSON: <%= json data.coupons.object %>
```

```java
com.invoiced.entity.Coupon@cb8fd57 JSON: <%= json data.coupons.object %>
```

This endpoint retrieves a specific coupon.

### HTTP Request

`GET /coupons/:id`

## Update a coupon

```shell
curl "https://api.invoiced.com/coupons/:id" \
  -u {API_KEY}: \
  -X PATCH \
  -d name="Nonprofits"
```

```ruby
coupon.name = "Nonprofits"
coupon.save
```

```php
<?php

$coupon->name = "Nonprofits";
$coupon->save();
```

```python
coupon.name = "Nonprofits"
coupon.save()
```

```java
coupon.name = "Nonprofits";
coupon.save();
```

> The above command returns JSON structured like this:

```shell
<%= json data.coupons._update %>
```

```ruby
#<Invoiced::Coupon:0x3fdbf95e4d08 id=S8L47J> JSON: <%= json data.coupons._update %>
```

```php
Invoiced\Coupon JSON: <%= json data.coupons._update %>
```

```python
<Coupon id=S8L47J at 0x3fdbf95e4d08> JSON: <%= json data.coupons._update %>
```

```java
com.invoiced.entity.Coupon@cb8fd57 JSON: <%= json data.coupons._update %>
```

Use this endpoint to update a coupon.

The properties that can be updated via this endpoint are limited. For other updates, it is necessary to delete and recreate the coupon.

### HTTP Request

`PATCH /coupons/:id`

### Attributes

Parameter | Type | Description
--------- | ---- | -----------
**name** | *string* | Coupon name
**metadata** | *object* | A hash of key/value pairs that can store additional information about this object.

## Delete a coupon

```shell
curl "https://api.invoiced.com/coupons/:id" \
  -u {API_KEY}: \
  -X DELETE
```

```ruby
coupon.delete
```

```php
<?php

$coupon->delete();
```

```python
coupon.delete()
```

```java
coupon.delete();
```

> The above command returns `204 No Content`

This endpoint deletes a specific coupon.

### HTTP Request

`DELETE /coupons/:id`

## List all coupons

```shell
curl "https://api.invoiced.com/coupons" \
  -u {API_KEY}:
```

```ruby
coupons, metadata = invoiced.Coupon.list(:per_page => 3)
```

```php
<?php

list($coupon, $metadata) = $invoiced->Coupon->all(['per_page' => 3]);
```

```python
coupons, metadata = invoiced.Coupon.list(per_page=3)
```

```java
EntityList<Coupon> coupon = conn.newCoupon().listAll();
```

> The above command returns JSON structured like this:

```shell
[
  <%= json data.coupons.object, 1 %>
]
```

```ruby
[
  #<Invoiced::Coupon:0x3fdbf95e4d08 id=S8L47J> JSON: <%= json data.coupons.object, 1 %>
]
```

```php
[
  Invoiced\Coupon JSON: <%= json data.coupons.object, 1 %>
]
```

```python
[
  <Coupon id=S8L47J at 0x3fdbf95e4d08> JSON: <%= json data.coupons.object, 1 %>
]
```

```java
[
  com.invoiced.entity.Coupon@c509a57 JSON: <%= json data.coupons.object, 1 %>
]
```

This endpoint retrieves all coupons.

### HTTP Request

`GET /coupons`

### Query Parameters

Parameter | Description
--------- | -----------
**sort** *string* | Column to sort by, i.e. `name asc`
**filter** *object* | Filter object
**updated_after** *timestamp* | Only gets records updated after the given timestamp